<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: ActsAsFerret::InstanceMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">ActsAsFerret::InstanceMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/vendor/plugins/acts_as_ferret/lib/instance_methods_rb.html">
                vendor/plugins/acts_as_ferret/lib/instance_methods.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000065">content_for_field_name</a>&nbsp;&nbsp;
      <a href="#M000057">disable_ferret</a>&nbsp;&nbsp;
      <a href="#M000063">document_number</a>&nbsp;&nbsp;
      <a href="#M000053">enable_ferret</a>&nbsp;&nbsp;
      <a href="#M000056">ferret_analyzer</a>&nbsp;&nbsp;
      <a href="#M000058">ferret_create</a>&nbsp;&nbsp;
      <a href="#M000060">ferret_destroy</a>&nbsp;&nbsp;
      <a href="#M000054">ferret_enable</a>&nbsp;&nbsp;
      <a href="#M000055">ferret_enabled?</a>&nbsp;&nbsp;
      <a href="#M000061">ferret_key</a>&nbsp;&nbsp;
      <a href="#M000059">ferret_update</a>&nbsp;&nbsp;
      <a href="#M000052">highlight</a>&nbsp;&nbsp;
      <a href="#M000064">query_for_record</a>&nbsp;&nbsp;
      <a href="#M000062">to_doc</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="ResultAttributes.html">ResultAttributes</a></span>
      </div>
    </div>

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000065" class="method-detail">
        <a name="M000065"></a>

        <div class="method-heading">
          <a href="#M000065" class="method-signature">
          <span class="method-name">content_for_field_name</span><span class="method-args">(field, via = field, dynamic_boost = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000065-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000065-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 158</span>
158:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">content_for_field_name</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">via</span> = <span class="ruby-identifier">field</span>, <span class="ruby-identifier">dynamic_boost</span> = <span class="ruby-keyword kw">nil</span>)
159:       <span class="ruby-identifier">field_data</span> = (<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">via</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">send</span>(<span class="ruby-identifier">via</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-node">&quot;@#{via}&quot;</span>)).<span class="ruby-identifier">to_s</span>
160:       <span class="ruby-comment cmt"># field_data = self.send(via) || self.instance_variable_get(&quot;@#{via}&quot;)</span>
161:       <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">dynamic_boost</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">boost_value</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">dynamic_boost</span>))
162:         <span class="ruby-identifier">field_data</span> = <span class="ruby-constant">Ferret</span><span class="ruby-operator">::</span><span class="ruby-constant">Field</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">field_data</span>)
163:         <span class="ruby-identifier">field_data</span>.<span class="ruby-identifier">boost</span> = <span class="ruby-identifier">boost_value</span>.<span class="ruby-identifier">to_i</span>
164:       <span class="ruby-keyword kw">end</span>
165:       <span class="ruby-identifier">field_data</span>
166:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000057" class="method-detail">
        <a name="M000057"></a>

        <div class="method-heading">
          <a href="#M000057" class="method-signature">
          <span class="method-name">disable_ferret</span><span class="method-args">(option = :once) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Disable <a href="../Ferret.html">Ferret</a> for this record for a specified
amount of time. ::once will disable <a href="../Ferret.html">Ferret</a> for
the next call to save (this is the default), ::always will do so for all
subsequent calls.
</p>
<p>
Note that this will turn off only the create and update hooks, but not the
destroy hook. I think that&#8216;s reasonable, if you think the opposite,
please tell me.
</p>
<p>
To manually trigger reindexing of a record after you&#8216;re finished
modifying it, you can call <a
href="InstanceMethods.html#M000059">ferret_update</a> directly instead of
save (remember to enable ferret again before).
</p>
<p>
When given a block, this will be executed without any ferret indexing of
this object taking place. The optional argument in this case can be used to
indicate if the object should be indexed after executing the block
(::index_when_finished). Automatic <a href="../Ferret.html">Ferret</a>
indexing of this object will be turned on after the block has been
executed. If passed ::index_when_true, the index will only be updated if
the block evaluated not to false or nil.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000057-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000057-source">
<pre>
    <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 82</span>
82:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disable_ferret</span>(<span class="ruby-identifier">option</span> = <span class="ruby-identifier">:once</span>)
83:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
84:         <span class="ruby-ivar">@ferret_disabled</span> = <span class="ruby-identifier">:always</span>
85:         <span class="ruby-identifier">result</span> = <span class="ruby-keyword kw">yield</span>
86:         <span class="ruby-identifier">ferret_enable</span>
87:         <span class="ruby-identifier">ferret_update</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">option</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:index_when_finished</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">option</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:index_when_true</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">result</span>)
88:         <span class="ruby-identifier">result</span>
89:       <span class="ruby-keyword kw">elsif</span> [<span class="ruby-identifier">:once</span>, <span class="ruby-identifier">:always</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">option</span>)
90:         <span class="ruby-ivar">@ferret_disabled</span> = <span class="ruby-identifier">option</span>
91:       <span class="ruby-keyword kw">else</span>
92:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;Invalid Argument #{option}&quot;</span>)
93:       <span class="ruby-keyword kw">end</span>
94:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000063" class="method-detail">
        <a name="M000063"></a>

        <div class="method-heading">
          <a href="#M000063" class="method-signature">
          <span class="method-name">document_number</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000063-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000063-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 150</span>
150:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">document_number</span>
151:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">aaf_index</span>.<span class="ruby-identifier">document_number</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ferret_key</span>)
152:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000053" class="method-detail">
        <a name="M000053"></a>

        <div class="method-heading">
          <a href="#M000053" class="method-signature">
          <span class="method-name">enable_ferret</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
re-eneable ferret indexing for this instance after a call to <a
href="InstanceMethods.html#M000057">disable_ferret</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000053-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000053-source">
<pre>
    <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 35</span>
35:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">enable_ferret</span>  
36:       <span class="ruby-ivar">@ferret_disabled</span> = <span class="ruby-keyword kw">nil</span> 
37:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000056" class="method-detail">
        <a name="M000056"></a>

        <div class="method-heading">
          <a href="#M000056" class="method-signature">
          <span class="method-name">ferret_analyzer</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the analyzer to use when adding this record to the index.
</p>
<p>
Override to return a specific analyzer for any record that is to be
indexed, i.e. specify a different analyzer based on language. Returns nil
by default so the global analyzer (specified with the acts_as_ferret call)
is used.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000056-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000056-source">
<pre>
    <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 59</span>
59:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ferret_analyzer</span>
60:       <span class="ruby-keyword kw">nil</span>
61:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000058" class="method-detail">
        <a name="M000058"></a>

        <div class="method-heading">
          <a href="#M000058" class="method-signature">
          <span class="method-name">ferret_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
add to index
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000058-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000058-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 97</span>
 97:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ferret_create</span>
 98:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ferret_enabled?</span>
 99:         <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ferret_create/update: #{self.ferret_key}&quot;</span>
100:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">aaf_index</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>
101:       <span class="ruby-keyword kw">else</span>
102:         <span class="ruby-identifier">ferret_enable</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ferret_disabled</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:once</span>
103:       <span class="ruby-keyword kw">end</span>
104:       <span class="ruby-keyword kw">true</span> <span class="ruby-comment cmt"># signal success to AR</span>
105:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000060" class="method-detail">
        <a name="M000060"></a>

        <div class="method-heading">
          <a href="#M000060" class="method-signature">
          <span class="method-name">ferret_destroy</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
remove from index
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000060-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000060-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 110</span>
110:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ferret_destroy</span>
111:       <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ferret_destroy: #{self.ferret_key}&quot;</span>
112:       <span class="ruby-keyword kw">begin</span>
113:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">aaf_index</span>.<span class="ruby-identifier">remove</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ferret_key</span>
114:       <span class="ruby-keyword kw">rescue</span>
115:         <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-node">&quot;Could not find indexed value for this object: #{$!}\n#{$!.backtrace}&quot;</span>)
116:       <span class="ruby-keyword kw">end</span>
117:       <span class="ruby-keyword kw">true</span> <span class="ruby-comment cmt"># signal success to AR</span>
118:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000054" class="method-detail">
        <a name="M000054"></a>

        <div class="method-heading">
          <span class="method-name">ferret_enable</span><span class="method-args">()</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="InstanceMethods.html#M000053">enable_ferret</a>
</p>
        </div>
      </div>

      <div id="method-M000055" class="method-detail">
        <a name="M000055"></a>

        <div class="method-heading">
          <a href="#M000055" class="method-signature">
          <span class="method-name">ferret_enabled?</span><span class="method-args">(is_bulk_index = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
returns true if ferret indexing is enabled for this record.
</p>
<p>
The optional is_bulk_index parameter will be true if the method is called
by rebuild_index or bulk_index, and false otherwise.
</p>
<p>
If is_bulk_index is true, the class level ferret_enabled state will be
ignored by this method (per-instance ferret_enabled checks however will
take place, so if you override this method to forbid indexing of certain
records you&#8216;re still safe).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000055-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000055-source">
<pre>
    <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 49</span>
49:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ferret_enabled?</span>(<span class="ruby-identifier">is_bulk_index</span> = <span class="ruby-keyword kw">false</span>)
50:       <span class="ruby-ivar">@ferret_disabled</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">is_bulk_index</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">ferret_enabled?</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">aaf_configuration</span>[<span class="ruby-identifier">:if</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">aaf_configuration</span>[<span class="ruby-identifier">:if</span>].<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>))
51:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000061" class="method-detail">
        <a name="M000061"></a>

        <div class="method-heading">
          <a href="#M000061" class="method-signature">
          <span class="method-name">ferret_key</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000061-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000061-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 120</span>
120:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ferret_key</span>
121:       <span class="ruby-node">&quot;#{self.class.name}-#{self.send self.class.primary_key}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">new_record?</span>
122:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000059" class="method-detail">
        <a name="M000059"></a>

        <div class="method-heading">
          <span class="method-name">ferret_update</span><span class="method-args">()</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="InstanceMethods.html#M000058">ferret_create</a>
</p>
        </div>
      </div>

      <div id="method-M000052" class="method-detail">
        <a name="M000052"></a>

        <div class="method-heading">
          <a href="#M000052" class="method-signature">
          <span class="method-name">highlight</span><span class="method-args">(query, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of strings with the matches highlighted. The
<tt>query</tt> can either be a String or a Ferret::Search::Query object.
</p>
<h3>Options</h3>
<table>
<tr><td valign="top">field:</td><td>field to take the content from. This field has to have it&#8216;s content
stored in the index (:store =&gt; :yes in your call to aaf). If not given,
all stored fields are searched, and the highlighted content found in all of
them is returned. set :<a href="InstanceMethods.html#M000052">highlight</a>
=&gt; :no in the field options to avoid highlighting of contents from a
:stored field.

</td></tr>
<tr><td valign="top">excerpt_length:</td><td>Default: 150. Length of excerpt to show. Highlighted terms will be in the
centre of the excerpt.

</td></tr>
<tr><td valign="top">num_excerpts:</td><td>Default: 2. Number of excerpts to return.

</td></tr>
<tr><td valign="top">pre_tag:</td><td>Default: &quot;&lt;em&gt;&quot;. Tag to place to the left of the match.

</td></tr>
<tr><td valign="top">post_tag:</td><td>Default: &quot;&lt;/em&gt;&quot;. This tag should close the +:pre_tag+.

</td></tr>
<tr><td valign="top">ellipsis:</td><td>Default: &quot;&#8230;&quot;. This is the string that is appended at the
beginning and end of excerpts (unless the excerpt hits the start or end of
the field. You&#8216;ll probably want to change this to a Unicode elipsis
character.

</td></tr>
</table>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000052-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000052-source">
<pre>
    <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 30</span>
30:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">highlight</span>(<span class="ruby-identifier">query</span>, <span class="ruby-identifier">options</span> = {})
31:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">aaf_index</span>.<span class="ruby-identifier">highlight</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ferret_key</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">options</span>)
32:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000064" class="method-detail">
        <a name="M000064"></a>

        <div class="method-heading">
          <a href="#M000064" class="method-signature">
          <span class="method-name">query_for_record</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000064-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000064-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 154</span>
154:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query_for_record</span>
155:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">aaf_index</span>.<span class="ruby-identifier">query_for_record</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ferret_key</span>)
156:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000062" class="method-detail">
        <a name="M000062"></a>

        <div class="method-heading">
          <a href="#M000062" class="method-signature">
          <span class="method-name">to_doc</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
turn this instance into a ferret document (which basically is a hash of
fieldname =&gt; value pairs)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000062-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000062-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/acts_as_ferret/lib/instance_methods.rb, line 126</span>
126:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_doc</span>
127:       <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;creating doc for class: #{self.ferret_key}&quot;</span>
128:       <span class="ruby-identifier">returning</span> <span class="ruby-constant">Ferret</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">doc</span><span class="ruby-operator">|</span>
129:         <span class="ruby-comment cmt"># store the id and class name of each item, and the unique key used for identifying the record</span>
130:         <span class="ruby-comment cmt"># even in multi-class indexes.</span>
131:         <span class="ruby-identifier">doc</span>[<span class="ruby-identifier">:key</span>] = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ferret_key</span>
132:         <span class="ruby-identifier">doc</span>[<span class="ruby-identifier">:id</span>] = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>
133:         <span class="ruby-identifier">doc</span>[<span class="ruby-identifier">:class_name</span>] = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>
134:       
135:         <span class="ruby-comment cmt"># iterate through the fields and add them to the document</span>
136:         <span class="ruby-identifier">aaf_configuration</span>[<span class="ruby-identifier">:defined_fields</span>].<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span>, <span class="ruby-identifier">config</span><span class="ruby-operator">|</span>
137:           <span class="ruby-identifier">doc</span>[<span class="ruby-identifier">field</span>] = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{field}_to_ferret&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">config</span>[<span class="ruby-identifier">:ignore</span>]
138:         <span class="ruby-keyword kw">end</span>
139:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">aaf_configuration</span>[<span class="ruby-identifier">:boost</span>]
140:           <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">aaf_configuration</span>[<span class="ruby-identifier">:boost</span>])
141:             <span class="ruby-identifier">boost</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">aaf_configuration</span>[<span class="ruby-identifier">:boost</span>]
142:             <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">boost</span> = <span class="ruby-identifier">boost</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">boost</span>
143:           <span class="ruby-keyword kw">else</span>
144:             <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">error</span> <span class="ruby-node">&quot;boost option should point to an instance method: #{aaf_configuration[:boost]}&quot;</span>
145:           <span class="ruby-keyword kw">end</span>
146:         <span class="ruby-keyword kw">end</span>
147:       <span class="ruby-keyword kw">end</span>
148:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>