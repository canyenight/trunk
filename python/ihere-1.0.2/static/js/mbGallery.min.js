jQuery.fn.mbMaskGallery=function(A){return this.each(function(){var N=!this.id?"maskGallery"+Math.floor(Math.random()*1000):this.id;var O=this;this.options={galleryMask:"mask/monitor.png",galleryLoader:"loader/loader.gif",galleryColor:"white",type:"normal",fadeTime:500,loader:true,loaderOpacity:0.3,slideTimer:2000};$.extend(this.options,A);var K="<table id='loader' cellpadding='0' cellspacing='0' width='100%' height='100%'><tr><td valign='middle' align='center'><img src='"+this.options.galleryLoader+"' alt='loading'></td></tr></table>";var I=$(this).find("img");$(O).empty();var L=(this.options.type=="random")?Math.floor(Math.random()*$(I).size()):0;$(O).mouseover(function(){$(this).css({cursor:$(I[L]).attr("url")?"pointer":"default"})});$(O).append("<div class='container'></div>");var M=$(this).find(".container");if(O.options.loader){$(M).append(K);var C=$(O).find("#loader");$(C).css({position:"absolute",top:0,left:0});if(!$.browser.msie){$(C).css({opacity:O.options.loaderOpacity})}}$(M).append("<image class='galleryImage' src=''>");var H=$(O).find(".galleryImage");$(M).append("<image class='galleryMask' src='"+this.options.galleryMask+"'>");var G=$(O).find(".galleryMask");$(G).click(function(){if($(I[L]).attr("url")){self.location.href=$(I[L]).attr("url")}});$(M).css({position:"absolute",overflow:"hidden",opacity:0,backgroundColor:O.options.galleryColor});$(H).css({position:"absolute",top:0,left:0,opacity:0});$(G).css({position:"absolute",top:0,left:0});var J=function(P){$(H).fadeTo(O.options.fadeTime,0,function(){$(H).attr("src",P);setTimeout(function(){$(H).fadeTo(O.options.fadeTime,1)},(O.options.fadeTime/2))})};var F=function F(P){var Q=new Image();Q.onload=function(){J(P)};Q.onerror=function(){alert("can't load "+P)};Q.src=P+"?rnd="+Math.floor(Math.random()*1000)};var E=function(){setTimeout(function(){F($(I[L]).attr("src"));$(M).fadeTo(O.options.fadeTime,1);var P=setInterval(function(){var Q=Math.floor(Math.random()*$(I).size());L=(O.options.type=="random")?Q:((L>=$(I).size()-1)?0:L+1);F($(I[L]).attr("src"))},O.options.slideTimer);if($.browser.msie6){D()}},200)};var B=function(P){var Q=new Image();Q.onload=function(){var R=O.options.galleryWidth?O.options.galleryWidth:$(G).width();var S=O.options.galleryHeight?O.options.galleryHeight:$(G).height();$(O).css({width:R,height:S});$(M).css({width:R,height:S});E()};Q.onerror=function(){alert("can't load mask: "+P)};Q.src=P+"?rnd="+Math.floor(Math.random()*1000)};function D(){for(var V=0;V<document.images.length;V++){var S=document.images[V];var U=S.src.toUpperCase();if(U.substring(U.length-3,U.length)=="PNG"){var Q=(S.id)?"id='"+S.id+"' ":"";var T=(S.className)?"class='"+S.className+"' ":"";var W=(S.title)?"title='"+S.title+"' ":"title='"+S.alt+"' ";var R="display:inline-block;"+S.style.cssText;if(S.align=="left"){R="float:left;"+R}if(S.align=="right"){R="float:right;"+R}if(S.parentElement.href){R="cursor:hand;"+R}var P="<span "+Q+T+W+' style="width:'+S.width+"px; height:"+S.height+"px;"+R+";filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+S.src+"', sizingMethod='scale');\"></span>";S.outerHTML=P;V=V-1}}}B(this.options.galleryMask)})};
