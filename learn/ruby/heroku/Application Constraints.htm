<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>


	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="verify-v1" content="J75JQ+WGFRjBEnhNT4hhYxgVTQmRHjd0v3JF+izUFvA=">
	<title>Heroku | Application Constraints</title>
	<link type="text/css" rel="stylesheet" href="Application%20Constraints_files/docs.css" media="screen">
	<link type="text/css" rel="stylesheet" href="Application%20Constraints_files/shCore.css">
	<link type="text/css" rel="stylesheet" href="Application%20Constraints_files/shThemeHeroku.css">
	<script type="text/javascript" src="Application%20Constraints_files/jquery-1.js"></script>
	<script type="text/javascript" src="Application%20Constraints_files/shCore.js"></script>
	<script type="text/javascript" src="Application%20Constraints_files/shBrushRuby.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			SyntaxHighlighter.config.tagName = 'code'
			SyntaxHighlighter.defaults['tag'] = false;
			SyntaxHighlighter.defaults['gutter'] = false;
			SyntaxHighlighter.defaults['toolbar'] = false;
			SyntaxHighlighter.all();
		});
	</script>
</head><body>
<div id="bodywrap">

	<style type="text/css">
#header { margin: 0; padding: 0; border: 0; font-weight: inherit; font-style: inherit; font-size: 100%; font-family: arial, helvetica, sans-serif; vertical-align: baseline; margin-bottom: 15px; }

#header { background-color: #29264d; border-bottom-style: solid; border-bottom-width: 3px; border-bottom-color: #494573; overflow: hidden; display: inline-block; }
#header { display: block; }
#header a { color: #c9c3e6; text-decoration: none; font-weight: normal; }
#header a:hover { color: #fff; }
#header #logo { margin: 20px 0 15px 25px; float: left; }
#header #logo a { display: block; text-indent: -9999px; width: 177px; height: 56px; overflow: hidden; background-image: url(http://heroku.com/images/v2/logo.png); background-repeat: no-repeat; }
#header ul { list-style-type: none; overflow: hidden; display: inline-block; float: right; margin-top: 30px; padding: 10px; }
#header ul { display: block; }
#header ul li { float: left; margin-left: 10px; }
#header ul li:first-child { margin-left: 0; }
#header ul li { border-left-style: solid; border-left-width: 2px; border-left-color: #534890; padding-left: 10px; font-size: 16px; }
#header ul li:first-child, #header ul li#account_login { border: none; margin-left: 0; padding-left: 0; }
#header ul li a.active { color: #bff740; }
#header ul li a.active:hover { color: #bff740; }
#header ul.account-links { background-color: #231d40; padding-left: 15px; padding-right: 15px; margin-right: 25px; margin-left: 10px; -moz-border-radius: 7px; -webkit-border-radius: 7px; }
#header ul.account-links a { color: #45a4ff; }
#header ul.account-links a:hover { color: #74d0f4; }
#header ul.account-links a.active { color: #bff740; }
#header ul.account-links a.active:hover { color: #bff740; }

</style>


<div id="header">
	
		<h5 id="logo"><a href="http://heroku.com/">Heroku</a></h5>
	

	<ul class="account-links inline">
		<div id="logged-in-links" style="display: none;">
			<li><a href="http://heroku.com/myapps">My Apps</a></li>
			<li><a href="http://heroku.com/account">My Account</a></li>
			<li><a href="http://heroku.com/logout">Logout</a></li>
		</div>
		<li id="account_login"><a href="http://heroku.com/login">Login</a></li>
	</ul>
	<ul class="info-links inline">
		<!-- <li><a href="http://heroku.com/about">About</a></li> -->
		<li><a href="http://heroku.com/how">How it Works</a></li>
		<li><a href="http://heroku.com/pricing">Pricing</a></li>
		<!-- <li><a href="http://blog.heroku.com/">Blog</a></li> -->
		<li><a href="http://docs.heroku.com/" class="active">Docs</a></li>
		<li><a href="http://support.heroku.com/" id="support_link">Support</a></li>
	</ul>
</div>

<script type="text/javascript">
	if (document.cookie.indexOf('heroku_session=') != -1) {
		document.getElementById('support_link').href = 'http://heroku.com/helpdesk/login';
		document.getElementById('logged-in-links').style.display = 'block';
		document.getElementById('account_login').style.display = 'none';
	}
</script>



	<div id="docsnav">
		<form action="/search" id="cse-search-box">
			<div id="search">
				<input name="cx" value="011016403564345195107:s5fypn6csxi" type="hidden">
				<input name="cof" value="FORID:10;NB:1" type="hidden">
				<input name="ie" value="UTF-8" type="hidden">
				<input style="border: 1px solid rgb(126, 157, 185); padding: 2px; background: rgb(255, 255, 255) url(http://www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) no-repeat scroll left center; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" name="q" size="31" type="text">
			</div>
		<input value="14d5058e-f79f-0935-acbc-c29344a71d2a" name="vid" type="hidden"></form>

		<ul>
			
				<li>
				<h3>Getting Started</h3>
				<ul>
					
						
							<li><a href="http://docs.heroku.com/heroku">What is Heroku?</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/quickstart">Quickstart Guide</a></li>
						
					
				</ul>
				</li>
			
				<li>
				<h3>Application Management</h3>
				<ul>
					
						
							<li><a href="http://docs.heroku.com/heroku-command">Installing the Heroku command-line tool</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/creating-apps">Creating apps</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/renaming-apps">Renaming apps</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/git">Deploying with Git</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/sharing">Collaborating with others</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/gems">Managing Gems</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/taps">Database import / export</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/console">Using the console</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/rake">Running rake tasks</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/config-vars">Config vars</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/backups">Backups</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/addons">Managing Addons</a></li>
						
					
				</ul>
				</li>
			
				<li>
				<h3>Platform Features</h3>
				<ul>
					
						
							<li><a href="http://docs.heroku.com/technologies">System Infrastructure</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/dynos">Dynos</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/database">SQL Database</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/http-caching">HTTP cache</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/rack">Rack apps</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/custom-domains">Custom domains</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/ssl">SSL</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/cron">Cron</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/background-jobs">Background jobs</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/s3">Storing uploads in S3</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/smtp">Outbound email</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/full-text-indexing">Full text search indexing</a></li>
						
					
				</ul>
				</li>
			
				<li>
				<h3>Troubleshooting</h3>
				<ul>
					
						
							<li class="current"><a>Application constraints</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/logs-exceptions">Logs and exceptions</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/errors">Error pages</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/performance">Performance</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/support">Getting support</a></li>
						
					
				</ul>
				</li>
			
		</ul>
	</div>

	<div id="content">
		<div class="topic_content">
			<h1>Application Constraints</h1>



<p>Heroku is a cloud hosting environment, and as such is subject to some
constraints that you may not be used to in a traditional hosting environment or
your local development setup. These constraints exist to ensure that your app
can take advantage of Heroku’s scalability and redundancy features.</p>

<a name="read-only-filesystem"></a>


	<ul id="toc">
		
			<li><a href="#read-only-filesystem">Read-only Filesystem</a></li>
		
			<li><a href="#ssh-access">SSH access</a></li>
		
			<li><a href="#interactive-rake-tasks">Interactive Rake tasks</a></li>
		
			<li><a href="#git-submodules">Git submodules</a></li>
		
			<li><a href="#large-static-assets">Large static assets</a></li>
		
			<li><a href="#slug-size">Slug size</a></li>
		
	</ul>


<h2>Read-only Filesystem</h2>

<p>Your app is compiled into a slug for fast distribution across the <a href="http://heroku.com/how/dyno_grid">dyno grid</a>.
The filesystem for the slug is read-only. This means you cannot
dynamically write to the filesystem for semi-permanent storage. The
following types of behaviors are <em>not</em> supported:</p>

<ul>
<li>Caching pages in the public directory</li>
<li>Saving uploaded assets to local disk (e.g. with attachment_fu or paperclip)</li>
<li>Writing full-text indexes with Ferret</li>
<li>Writing to a filesystem database like SQLite or GDBM</li>
<li>Accessing a git repo for an app like git-wiki</li>
</ul>


<p>There are two directories that <em>are</em> writeable: <code>./tmp</code> and <code>./log</code>
(under your application root). If you wish to drop a file temporarily
for the duration of the request, you can write to a filename like <code>#{RAILS_ROOT}/tmp/myfile_#{Process.pid}</code>.
There is no guarantee that this file will be there on subsequent
requests (although it might be), so this should not be used for any
kind of permanent storage.</p>

<p>So how do you accomplish each of the following in a way that is compatible with a cloud environment?</p>

<ul>
<li>Caching – Use HTTP headers instead of writing to the filesystem.  See <a href="http://docs.heroku.com/http-caching#example-caching-barcode-images-generated-with-imagemagick">an example of dynamically generated image caching</a>.</li>
<li>Saving uploaded assets – Use an asset store system like Amazon S3.  See <a href="http://docs.heroku.com/constraints#large-static-assets">large static assets</a>.</li>
<li>Writing full-text indexes with Ferret – You can stash temporary indexes in <code>tmp</code>, as described <a href="http://docs.heroku.com/full-text-indexing#ferret">here</a>.</li>
<li>SQLite or GDBM – Use the provided PostgreSQL database instead of a filesystem database.</li>
<li>Accessing a git repo – Sorry, but git-wiki and apps that use a
similar technique won’t work on Heroku. As clever as git-wiki is, it is
fundamentally non-scalable and non-replicatable.</li>
</ul>


<p>Further reading: Adam Wiggins’s <a href="http://adam.blog.heroku.com/past/2008/7/2/readonly_source_trees/">Read Only Source Trees</a></p>

<a name="ssh-access"></a><h2>SSH access</h2>

<p>Since your app is spread across many servers, there is no single place to ssh. In short, <a href="http://heroku.com/how/dyno_grid#2">forget servers</a>.</p>

<p>You can, if you wish, run shell commands from your app’s console with backticks:</p>

<pre><code>$ heroku console
Ruby console for myapp.heroku.com
&gt;&gt; `pwd`
=&gt; "/mnt/home/slugs/1938_94afba3_0815/mnt\n"
</code></pre>

<p>However, there is little to be gained from doing so.  You can’t write to the
filesystem, and each command may run on a different virtual machine. When you
find yourself wanting ssh access, there’s probably a better approach that
properly accounts for Heroku’s distributed server environment. The <a href="http://docs.heroku.com/heroku-command">heroku
command line tool</a> supports most operations you would
perform with ssh in traditional hosting environments.</p>

<a name="interactive-rake-tasks"></a><h2>Interactive Rake tasks</h2>

<p>Some open source apps, such as Radiant CMS, prompt for information on the
console during rake setup tasks. Since the rake command is being run over
an HTTP request rather than a tty, it is not possible to answer these prompts.</p>

<p>There are several possible workarounds. You may be able to pass environment
variables to the rake command to avoid prompts. Another is that you can do
all your database setup locally, then import the resulting configured database
to Heroku. Another would be to manually set up your database, using the Heroku
console. Finally, you could try editing the rake tasks, removing the prompts
and instead filling in your responses in the code.</p>

<p>Generally speaking, interactive rake tasks are bad practice and should be
avoided.</p>

<a name="git-submodules"></a><h2>Git submodules</h2>

<p>Git submodules are not currently supported. We’re evaluating whether or not to
support them in the future; in the meantime you’ll need to track any submodules
in the main project. You can do so like this:</p>

<pre><code>$ cd myapp
$ rm -rf `find . -mindepth 2 -name .git`
$ git add .
$ git commit -m "brought submodules into the main repo"
</code></pre>

<p>Run this command if you’re not sure whether your project uses submodules:</p>

<pre><code>$ find . -mindepth 2 -name .git
</code></pre>

<p>If it prints any output, you have submodules.</p>

<a name="large-static-assets"></a><h2>Large static assets</h2>

<p>Heroku is not intended to be used to serve large static assets such
as videos, PDFs, or mp3s. The good news is that there are many
excellent services that work extremely well for this, so you can
integrate your app with one of those. Perhaps the best-known is <a href="http://aws.amazon.com/s3/">Amazon S3</a>, and it is the one we recommend.</p>

<p>To use S3 with your Heroku app, upload your assets to your S3 account using the command line, or a graphical browser like <a href="https://addons.mozilla.org/en-US/firefox/addon/3247">this Firefox add-on</a> or <a href="http://people.no-distance.net/ol/software/s3/">this OS X client</a>.
Once uploaded, you can make your assets public. Take the URL, which
will be something like “http://s3.amazonaws.com/bucketname/filename”,
and paste it into your views inside your app wherever you need to serve
the asset to your users.</p>

<p>For writing uploaded files to S3, use the <a href="http://amazon.rubyforge.org/">S3 gem</a> from within your Ruby code, or use <a href="http://thoughtbot.com/projects/paperclip">Paperclip</a> or <a href="http://clarkware.com/cgi/blosxom/2007/02/24#FileUploadFu">attachment_fu</a>, specifying the S3 storage backend.</p>

<a name="slug-size"></a><h2>Slug size</h2>

<p>The size of your compiled slug greatly affects the speed with which
is can be distributed across our dyno grid. Smaller slugs will result
in apps that are faster to scale and more resilient to partial
infrastructure outages.</p>

<p>Your slug size is shown at compile time, or you can approximate it
locally by creating a zip or .tar.gz archive of your app without the
.git directory, and then adding the size of any gems specified in your
.gems manifest.</p>

<p>The maximum slug size is 50MB. Most apps should be far below this
size. Anything under 10MB is good. If you exceed 20MB, you should think
about trying to lean down your app.</p>

<p>If you find yourself with a large (&gt;= 20MB) slug, here are some techniques for reducing its size:</p>

<ul>
<li>Move large assets like PDFs or audio files to asset storage, and described in the previous section.</li>
<li>Remove files stored inside the app’s repository but which are
unnecessary to run the app. For example, PSD mockups, or large design
documents.</li>
<li>Look for ways to reduce the number of gems or plugins required in
production. For example, using the rspec-rails gem instead of
installing the RSpec plugin in your vendor/plugins.</li>
</ul>




	<div id="next_section">Next: <a href="http://docs.heroku.com/logs-exceptions">Logs and exceptions →</a></div>


<a href="http://docs.heroku.com/logs-exceptions">		</a></div>
<a href="http://docs.heroku.com/logs-exceptions">	</a></div>
</div>

<!-- google site search -->
<script type="text/javascript" src="Application%20Constraints_files/jsapi"></script>
<script type="text/javascript">google.load("elements", "1", {packages: "transliteration"});</script><script src="Application%20Constraints_files/a" type="text/javascript"></script><a href="http://docs.heroku.com/logs-exceptions"><link href="Application%20Constraints_files/transliteration.css" type="text/css" rel="stylesheet"><script src="Application%20Constraints_files/transliteration.js" type="text/javascript"></script>
<script type="text/javascript" src="Application%20Constraints_files/t13n.htm"></script>
<script type="text/javascript" src="Application%20Constraints_files/brand.htm"></script>


<!-- loopfuse -->
<script src="Application%20Constraints_files/listen.js" type="text/javascript"></script>
<script type="text/javascript">
_lf_cid = "LF_024e931f";
_lf_remora();
</script>

<!-- google analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="Application%20Constraints_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-2989055-1");
pageTracker._setDomainName(".heroku.com");
pageTracker._trackPageview();
} catch(err) {}
</script>


</a></body></html>