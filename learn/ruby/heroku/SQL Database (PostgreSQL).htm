<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>


	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="verify-v1" content="J75JQ+WGFRjBEnhNT4hhYxgVTQmRHjd0v3JF+izUFvA=">
	<title>Heroku | SQL Database (PostgreSQL)</title>
	<link type="text/css" rel="stylesheet" href="SQL%20Database%20%28PostgreSQL%29_files/docs.css" media="screen">
	<link type="text/css" rel="stylesheet" href="SQL%20Database%20%28PostgreSQL%29_files/shCore.css">
	<link type="text/css" rel="stylesheet" href="SQL%20Database%20%28PostgreSQL%29_files/shThemeHeroku.css">
	<script type="text/javascript" src="SQL%20Database%20%28PostgreSQL%29_files/jquery-1.js"></script>
	<script type="text/javascript" src="SQL%20Database%20%28PostgreSQL%29_files/shCore.js"></script>
	<script type="text/javascript" src="SQL%20Database%20%28PostgreSQL%29_files/shBrushRuby.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			SyntaxHighlighter.config.tagName = 'code'
			SyntaxHighlighter.defaults['tag'] = false;
			SyntaxHighlighter.defaults['gutter'] = false;
			SyntaxHighlighter.defaults['toolbar'] = false;
			SyntaxHighlighter.all();
		});
	</script>
</head><body>
<div id="bodywrap">

	<style type="text/css">
#header { margin: 0; padding: 0; border: 0; font-weight: inherit; font-style: inherit; font-size: 100%; font-family: arial, helvetica, sans-serif; vertical-align: baseline; margin-bottom: 15px; }

#header { background-color: #29264d; border-bottom-style: solid; border-bottom-width: 3px; border-bottom-color: #494573; overflow: hidden; display: inline-block; }
#header { display: block; }
#header a { color: #c9c3e6; text-decoration: none; font-weight: normal; }
#header a:hover { color: #fff; }
#header #logo { margin: 20px 0 15px 25px; float: left; }
#header #logo a { display: block; text-indent: -9999px; width: 177px; height: 56px; overflow: hidden; background-image: url(http://heroku.com/images/v2/logo.png); background-repeat: no-repeat; }
#header ul { list-style-type: none; overflow: hidden; display: inline-block; float: right; margin-top: 30px; padding: 10px; }
#header ul { display: block; }
#header ul li { float: left; margin-left: 10px; }
#header ul li:first-child { margin-left: 0; }
#header ul li { border-left-style: solid; border-left-width: 2px; border-left-color: #534890; padding-left: 10px; font-size: 16px; }
#header ul li:first-child, #header ul li#account_login { border: none; margin-left: 0; padding-left: 0; }
#header ul li a.active { color: #bff740; }
#header ul li a.active:hover { color: #bff740; }
#header ul.account-links { background-color: #231d40; padding-left: 15px; padding-right: 15px; margin-right: 25px; margin-left: 10px; -moz-border-radius: 7px; -webkit-border-radius: 7px; }
#header ul.account-links a { color: #45a4ff; }
#header ul.account-links a:hover { color: #74d0f4; }
#header ul.account-links a.active { color: #bff740; }
#header ul.account-links a.active:hover { color: #bff740; }

</style>


<div id="header">
	
		<h5 id="logo"><a href="http://heroku.com/">Heroku</a></h5>
	

	<ul class="account-links inline">
		<div id="logged-in-links" style="display: none;">
			<li><a href="http://heroku.com/myapps">My Apps</a></li>
			<li><a href="http://heroku.com/account">My Account</a></li>
			<li><a href="http://heroku.com/logout">Logout</a></li>
		</div>
		<li id="account_login"><a href="http://heroku.com/login">Login</a></li>
	</ul>
	<ul class="info-links inline">
		<!-- <li><a href="http://heroku.com/about">About</a></li> -->
		<li><a href="http://heroku.com/how">How it Works</a></li>
		<li><a href="http://heroku.com/pricing">Pricing</a></li>
		<!-- <li><a href="http://blog.heroku.com/">Blog</a></li> -->
		<li><a href="http://docs.heroku.com/" class="active">Docs</a></li>
		<li><a href="http://support.heroku.com/" id="support_link">Support</a></li>
	</ul>
</div>

<script type="text/javascript">
	if (document.cookie.indexOf('heroku_session=') != -1) {
		document.getElementById('support_link').href = 'http://heroku.com/helpdesk/login';
		document.getElementById('logged-in-links').style.display = 'block';
		document.getElementById('account_login').style.display = 'none';
	}
</script>



	<div id="docsnav">
		<form action="/search" id="cse-search-box">
			<div id="search">
				<input name="cx" value="011016403564345195107:s5fypn6csxi" type="hidden">
				<input name="cof" value="FORID:10;NB:1" type="hidden">
				<input name="ie" value="UTF-8" type="hidden">
				<input style="border: 1px solid rgb(126, 157, 185); padding: 2px; background: rgb(255, 255, 255) url(http://www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) no-repeat scroll left center; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;" name="q" size="31" type="text">
			</div>
		<input value="14d5058e-f79f-0935-acbc-c29344a71d2a" name="vid" type="hidden"></form>

		<ul>
			
				<li>
				<h3>Getting Started</h3>
				<ul>
					
						
							<li><a href="http://docs.heroku.com/heroku">What is Heroku?</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/quickstart">Quickstart Guide</a></li>
						
					
				</ul>
				</li>
			
				<li>
				<h3>Application Management</h3>
				<ul>
					
						
							<li><a href="http://docs.heroku.com/heroku-command">Installing the Heroku command-line tool</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/creating-apps">Creating apps</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/renaming-apps">Renaming apps</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/git">Deploying with Git</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/sharing">Collaborating with others</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/gems">Managing Gems</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/taps">Database import / export</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/console">Using the console</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/rake">Running rake tasks</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/config-vars">Config vars</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/backups">Backups</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/addons">Managing Addons</a></li>
						
					
				</ul>
				</li>
			
				<li>
				<h3>Platform Features</h3>
				<ul>
					
						
							<li><a href="http://docs.heroku.com/technologies">System Infrastructure</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/dynos">Dynos</a></li>
						
					
						
							<li class="current"><a>SQL Database</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/http-caching">HTTP cache</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/rack">Rack apps</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/custom-domains">Custom domains</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/ssl">SSL</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/cron">Cron</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/background-jobs">Background jobs</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/s3">Storing uploads in S3</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/smtp">Outbound email</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/full-text-indexing">Full text search indexing</a></li>
						
					
				</ul>
				</li>
			
				<li>
				<h3>Troubleshooting</h3>
				<ul>
					
						
							<li><a href="http://docs.heroku.com/constraints">Application constraints</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/logs-exceptions">Logs and exceptions</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/errors">Error pages</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/performance">Performance</a></li>
						
					
						
							<li><a href="http://docs.heroku.com/support">Getting support</a></li>
						
					
				</ul>
				</li>
			
		</ul>
	</div>

	<div id="content">
		<div class="topic_content">
			<h1>SQL Database (PostgreSQL)</h1>



<a name="overview"></a>


	<ul id="toc">
		
			<li><a href="#overview">Overview</a></li>
		
			<li><a href="#using-the-databaseurl-environment-variable-sequel--datamapper">Using the DATABASE_URL environment variable (Sequel / DataMapper)</a></li>
		
			<li><a href="#frequently-asked-questions">Frequently Asked Questions</a></li>
		
			<li><a href="#common-issues-migrating-to-postgresql">Common issues migrating to PostgreSQL</a></li>
		
	</ul>


<h2>Overview</h2>

<p>Heroku provides each app with a full-featured <a href="http://postgresql.org/">PostgreSQL
database</a>. For Rails apps, database connectivity is
configured automatically — your app should <em>just work</em>. For app’s that use the
DataMapper or Sequel ORMs, the <code>DATABASE_URL</code> environment variable contains
database connection details.</p>

<p>There are <a href="http://heroku.com/pricing">multiple database packages to choose from</a>,
and you can change plans at any time. The <em>Blossom</em>, <em>Koi</em>, and <em>Crane</em> plans
are hosted within Heroku’s shared database cluster, while the <em>Ronin</em>, <em>Fugu</em>,
and <em>Zilla</em> plans are hosted on a high-performance machine dedicated to your
app. Database redundancy and failover is fully managed by Heroku’s infrastructure
regardless of plan. Upgrading from the shared tier to the dedicated tier is
seamless and managed by Heroku as well.</p>

<a name="using-the-databaseurl-environment-variable-sequel--datamapper"></a><h2>Using the DATABASE_URL environment variable (Sequel / DataMapper)</h2>

<p>Your database credentials and connection details can be obtained from the
<code>DATABASE_URL</code> environment variable. This is especially useful for ORMs like
DataMapper and Sequel that use database URLs / connection strings instead of
files for configuration.</p>

<p>A popular idiom is to use the value of the <code>DATABASE_URL</code> environment variable
when defined, but fallback on a default database URL otherwise.</p>

<p>Configuring Sequel:</p>

<pre><code>Sequel.connect(ENV['DATABASE_URL'] || 'sqlite://my.db')
</code></pre>

<p>Configuring DataMapper:</p>

<pre><code>DataMapper.setup(:default, ENV['DATABASE_URL'] || 'sqlite3://my.db')
</code></pre>

<a name="frequently-asked-questions"></a><h2>Frequently Asked Questions</h2>

<h3>What database does Heroku use?</h3>

<p>PostgreSQL 8.3.</p>

<h3>I have an app built against MySQL. Is it going to work with Heroku?</h3>

<p>Yes, as long as no database specific queries are used. For most apps, it
just works, and in a few cases a quick code fix is all that’s required (see
<a href="#common-issues-migrating-to-postgres">Common Issues</a> below).</p>

<h3>How can import my existing data to Heroku?</h3>

<p>The Heroku command line tool includes a <code>db:push</code>, which can be used to import
data from your local environment into your remote Heroku database. See the
<a href="http://docs.heroku.com/taps#import-push-to-heroku">database import / export</a> topic for more
information.</p>

<h3>Can I export my data out of Heroku?</h3>

<p>Certainly. You can export your remote Heroku database at any time using the
<code>heroku db:pull</code> command. See the <a href="http://docs.heroku.com/taps#export-pull-from-heroku">database import / export</a>
topic for more information.</p>

<h3>Can I access my database from another app/host?</h3>

<p>No, connecting to your database from machines outside of Heroku is not
supported. We recommend that you encapsulate data access in an API to manipulate
it.</p>

<a name="common-issues-migrating-to-postgresql"></a><h2>Common issues migrating to PostgreSQL</h2>

<p>Below are a list of common mistakes that might result in problems when migrating
your Rails app from SQLite or MySQL to PostgreSQL:</p>

<h3>Invalid operator</h3>

<p>Example: <em>PGError: ERROR:  operator does not exist: character varying = integer</em></p>

<p>Cause: PostgreSQL is more sensitive with data types than MySQL or SQlite.
PostgreSQL will check and throw errors when an operator is applied to an
unsupported data type. For instance, you can’t compare strings with integers
without casting.</p>

<p>Solution: Make sure the operator is adequate for the data type.  ActiveRecord
does this automatically when you use an interpolated condition form.</p>

<p>Array conditions:</p>

<pre><code>:conditions =&gt; ['column1 = ? AND column2 = ?', value1, value2]
</code></pre>

<p>Hash conditions:</p>

<pre><code>:conditions =&gt; { :column1 =&gt; value1, :column2 =&gt; value2 }
</code></pre>

<h3>Binary field limit</h3>

<p>Cause: PostgreSQL doesn’t limit binary fields. Any migrations adding a <code>:binary</code>
field with the <code>:limit</code> option will raise a syntax error.</p>

<p>Solution: Omit the <code>:limit</code> for binary fields if possible — or test the DB
before running it (see Testing the Database below).</p>

<h3>Table doesn’t exist</h3>

<p>Example: <em>PGError: ERROR: relation “documents” does not exist</em></p>

<p>Cause: This is the standard message displayed by Postgres when a table doesn’t
exists. That means your query is referencing a table that is not on the
database.</p>

<p>Solution: Make sure your migrations ran normally, and that you’re referencing a
table that exists.</p>

<p>You can see what tables you have running the following command on <code>heroku
console</code>:</p>

<pre><code>&gt;&gt; ActiveRecord::Base.connection.tables
</code></pre>

<h3>Cannot change column type</h3>

<p>Example: <em>PGError: ERROR: column “verified_at” cannot be cast to type “date”</em></p>

<p>Cause: PostgreSQL doesn’t know how to cast all the rows in that table to the
specified type. Most likely it means you have an integer or a string in that
column.</p>

<p>Solution: Inspect your records and make sure they can be converted to the new
type. Sometimes it’s easier to just avoid using <code>change_column</code>,
renaming/creating a new column instead.</p>

<h3>Testing the Database</h3>

<p>To fix database-specific queries where ActiveRecord won’t help (for instance,
foreign keys), the only solution is to test the database before running a
migration or query:</p>

<pre><code>case ActiveRecord::Base.connection.adapter_name
when 'SQLite'
     execute 'sqlite specific query'
when 'PostgreSQL'
     execute 'postgres specific query'
else
     raise 'Migration not implemented for this DB adapter'
end
</code></pre>



	<div id="next_section">Next: <a href="http://docs.heroku.com/http-caching">HTTP cache →</a></div>


<a href="http://docs.heroku.com/http-caching">		</a></div>
<a href="http://docs.heroku.com/http-caching">	</a></div>
</div>

<!-- google site search -->
<script type="text/javascript" src="SQL%20Database%20%28PostgreSQL%29_files/jsapi"></script>
<script type="text/javascript">google.load("elements", "1", {packages: "transliteration"});</script><script src="SQL%20Database%20%28PostgreSQL%29_files/a" type="text/javascript"></script><a href="http://docs.heroku.com/http-caching"><link href="SQL%20Database%20%28PostgreSQL%29_files/transliteration.css" type="text/css" rel="stylesheet"><script src="SQL%20Database%20%28PostgreSQL%29_files/transliteration.js" type="text/javascript"></script>
<script type="text/javascript" src="SQL%20Database%20%28PostgreSQL%29_files/t13n.htm"></script>
<script type="text/javascript" src="SQL%20Database%20%28PostgreSQL%29_files/brand.htm"></script>


<!-- loopfuse -->
<script src="SQL%20Database%20%28PostgreSQL%29_files/listen.js" type="text/javascript"></script>
<script type="text/javascript">
_lf_cid = "LF_024e931f";
_lf_remora();
</script>

<!-- google analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="SQL%20Database%20%28PostgreSQL%29_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-2989055-1");
pageTracker._setDomainName(".heroku.com");
pageTracker._trackPageview();
} catch(err) {}
</script>


</a></body></html>